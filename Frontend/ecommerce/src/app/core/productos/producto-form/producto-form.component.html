<div class="container py-3">
    <h3>{{ modoEditar() ? 'Editar producto' : 'Nuevo producto' }}</h3>
  
    <div *ngIf="error()" class="alert alert-danger">{{ error() }}</div>
  
    <form [formGroup]="form" (ngSubmit)="submit()" class="row g-3">
      <div class="col-12 col-md-6">
        <label class="form-label">Nombre</label>
        <input type="text" class="form-control" formControlName="nombre">
        <div class="text-danger" *ngIf="form.controls.nombre.touched && form.controls.nombre.invalid">
          Requerido (máx 160).
        </div>
      </div>
  
      <div class="col-12">
        <label class="form-label">Descripción</label>
        <textarea rows="4" class="form-control" formControlName="descripcion"></textarea>
        <div class="text-danger" *ngIf="form.controls.descripcion.touched && form.controls.descripcion.invalid">
          Requerida.
        </div>
      </div>
  
      <div class="col-12 col-md-6">
        <label class="form-label">Precio (Q)</label>
        <input type="number" step="0.01" class="form-control" formControlName="precio">
        <div class="text-danger" *ngIf="form.controls.precio.touched && form.controls.precio.invalid">
          Debe ser &gt; 0.
        </div>
      </div>
  
      <div class="col-12 col-md-6">
        <label class="form-label">Stock</label>
        <input type="number" class="form-control" formControlName="stock">
        <div class="text-danger" *ngIf="form.controls.stock.touched && form.controls.stock.invalid">
          Debe ser ≥ 0.
        </div>
      </div>
  
      <div class="col-12 col-md-6">
        <label class="form-label">Condición</label>
        <select class="form-select" formControlName="condicion">
          <option value="nuevo">Nuevo</option>
          <option value="usado">Usado</option>
        </select>
      </div>
  
      <div class="col-12 col-md-6">
        <label class="form-label">Categoría</label>
        <select class="form-select" formControlName="idCategoria">
          <option [ngValue]="null" disabled>Selecciona...</option>
          <option *ngFor="let c of categorias()" [value]="c.id">{{ c.nombre }}</option>
        </select>
        <div class="text-danger" *ngIf="form.controls.idCategoria.touched && form.controls.idCategoria.invalid">
          Requerida.
        </div>
      </div>
  
      <div class="col-12">
        <label class="form-label">Imagen</label>
        <input type="file" class="form-control" accept="image/*" (change)="onFile($event)">
        <div class="mt-2" *ngIf="form.value.imagenUrl">
          <img [src]="form.value.imagenUrl" alt="preview" style="max-width: 240px;">
        </div>
      </div>    
  
      <div class="col-12 d-flex gap-2">
        <button class="btn btn-primary" type="submit" [disabled]="loading()">
          {{ modoEditar() ? 'Guardar cambios' : 'Publicar' }}
        </button>
        <a class="btn btn-outline-secondary" routerLink="/mis-productos">Cancelar</a>
      </div>
    </form>
  </div>
  
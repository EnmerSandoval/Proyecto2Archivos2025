<div class="container py-4">
    <h4 class="mb-3">Catálogo</h4>
  
    <form class="row g-2 align-items-end mb-3" [formGroup]="form" (ngSubmit)="submit()">
      <div class="col-sm-4">
        <label class="form-label">Categoría</label>
        <select class="form-select" formControlName="catId">
          <option [ngValue]="null">Todas</option>
          <option *ngFor="let c of categorias()" [ngValue]="c.id">{{ c.nombre }}</option>
        </select>
      </div>
      <div class="col-sm-5">
        <label class="form-label">Buscar</label>
        <input class="form-control" formControlName="q" placeholder="Nombre o descripción…">
      </div>
      <div class="col-sm-3 d-grid">
        <button class="btn btn-primary" type="submit" [disabled]="loading()">Buscar</button>
      </div>
    </form>
  
    <div *ngIf="error()" class="alert alert-danger">{{ error() }}</div>
    <div *ngIf="loading()" class="alert alert-info">Cargando…</div>
  
  <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-3 justify-content-center">
    <div class="col" *ngFor="let p of items(); trackBy: trackById">
      <app-producto-card
        class="h-100"          
        [p]="p"
        [showAddToCart]="true"
        (addToCart)="agregarAlCarrito(p)">
      </app-producto-card>
    </div>
  </div>


  
    <div *ngIf="!loading() && !items().length" class="text-muted">
      No hay resultados.
    </div>
  
    <div class="d-flex justify-content-between align-items-center mt-3" *ngIf="totalPages() > 0">
      <button class="btn btn-outline-secondary" (click)="prev()" [disabled]="page() === 0">« Anterior</button>
      <div>Página {{ page() + 1 }} de {{ totalPages() }}</div>
      <button class="btn btn-outline-secondary" (click)="next()" [disabled]="page() + 1 >= totalPages()">Siguiente »</button>
    </div>
  </div>
  